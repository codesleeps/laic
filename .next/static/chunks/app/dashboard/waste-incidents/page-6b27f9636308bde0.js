(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9678],{286:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(157).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},4384:(e,s,a)=>{Promise.resolve().then(a.bind(a,9507))},7070:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(157).A)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]])},7554:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(157).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},8271:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(157).A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},8390:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(157).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},9507:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>I});var t=a(5155),r=a(2115),l=a(3989),i=a(6695),c=a(285),d=a(2523),n=a(5057),o=a(8539),h=a(6126),x=a(4165),m=a(9409),p=a(5127),u=a(7554),j=a(157);let g=(0,j.A)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);var v=a(7648),y=a(286);let N=(0,j.A)("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]),b=(0,j.A)("Move",[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]]);var _=a(8271),w=a(1949),k=a(8046),f=a(7070),A=a(8390),C=a(5074),M=a(9572),S=a(6671);let F={low:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",high:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",critical:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"},W={open:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",in_progress:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",resolved:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",closed:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"},D={D:(0,t.jsx)(u.A,{className:"h-4 w-4"}),O:(0,t.jsx)(g,{className:"h-4 w-4"}),W:(0,t.jsx)(v.A,{className:"h-4 w-4"}),N:(0,t.jsx)(y.A,{className:"h-4 w-4"}),T:(0,t.jsx)(N,{className:"h-4 w-4"}),I:(0,t.jsx)(g,{className:"h-4 w-4"}),M:(0,t.jsx)(b,{className:"h-4 w-4"}),E:(0,t.jsx)(_.A,{className:"h-4 w-4"})};function I(){let{data:e,error:s,isLoading:a,mutate:u}=(0,l.PV)(),{data:j}=(0,l.eN)(),{data:g}=(0,l.YK)(),{data:y}=(0,l.G$)(),[N,b]=(0,r.useState)(""),[_,I]=(0,r.useState)("all"),[q,T]=(0,r.useState)("all"),[H,L]=(0,r.useState)(!1),[R,V]=(0,r.useState)(!1),[E,J]=(0,r.useState)({project_id:"",category_id:"",description:"",severity:"medium",cost_impact:"",time_impact_hours:"",root_cause:"",corrective_action:"",reported_by:""}),Z=()=>{J({project_id:"",category_id:"",description:"",severity:"medium",cost_impact:"",time_impact_hours:"",root_cause:"",corrective_action:"",reported_by:""})},z=async()=>{if(!E.project_id||!E.category_id||!E.description)return void S.oR.error("Please fill in all required fields");V(!0);try{await (0,l.ZF)({project_id:E.project_id,category_id:E.category_id,description:E.description,severity:E.severity,cost_impact:E.cost_impact?parseFloat(E.cost_impact):0,time_impact_hours:E.time_impact_hours?parseFloat(E.time_impact_hours):0,root_cause:E.root_cause,corrective_action:E.corrective_action,reported_by:E.reported_by}),S.oR.success("Waste incident reported successfully"),L(!1),Z(),u()}catch(e){S.oR.error("Failed to report incident")}finally{V(!1)}},O=(e||[]).filter(e=>{var s,a;let t=(null==(s=e.description)?void 0:s.toLowerCase().includes(N.toLowerCase()))||(null==(a=e.root_cause)?void 0:a.toLowerCase().includes(N.toLowerCase())),r="all"===_||e.severity===_,l="all"===q||e.waste_category_id===q;return t&&r&&l}),$=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e||0),B=(e||[]).reduce((e,s)=>e+(s.estimated_cost_impact||0),0),P=(e||[]).reduce((e,s)=>e+(s.estimated_time_impact||0),0),U=(e||[]).filter(e=>"critical"===e.severity||"high"===e.severity).length;return a?(0,t.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):s?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-96 gap-4",children:[(0,t.jsx)(w.A,{className:"h-12 w-12 text-red-500"}),(0,t.jsx)("p",{className:"text-lg text-muted-foreground",children:"Failed to load waste incidents"}),(0,t.jsx)(c.$,{onClick:()=>u(),children:"Try Again"})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Waste Incidents"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Track and analyze the 8 wastes (DOWNTIME) across projects"})]}),(0,t.jsxs)(x.lG,{open:H,onOpenChange:L,children:[(0,t.jsx)(x.zM,{asChild:!0,children:(0,t.jsxs)(c.$,{onClick:Z,children:[(0,t.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"Report Incident"]})}),(0,t.jsxs)(x.Cf,{className:"sm:max-w-[600px]",children:[(0,t.jsxs)(x.c7,{children:[(0,t.jsx)(x.L3,{children:"Report Waste Incident"}),(0,t.jsx)(x.rr,{children:"Document a waste incident for root cause analysis and continuous improvement"})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4 max-h-[60vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(n.J,{htmlFor:"project",children:"Project *"}),(0,t.jsxs)(m.l6,{value:E.project_id,onValueChange:e=>J({...E,project_id:e}),children:[(0,t.jsx)(m.bq,{children:(0,t.jsx)(m.yv,{placeholder:"Select project"})}),(0,t.jsx)(m.gC,{children:(g||[]).map(e=>(0,t.jsx)(m.eb,{value:e.id,children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(n.J,{htmlFor:"category",children:"Waste Category *"}),(0,t.jsxs)(m.l6,{value:E.category_id,onValueChange:e=>J({...E,category_id:e}),children:[(0,t.jsx)(m.bq,{children:(0,t.jsx)(m.yv,{placeholder:"Select category"})}),(0,t.jsx)(m.gC,{children:(y||[]).map(e=>(0,t.jsxs)(m.eb,{value:e.id,children:["[",e.code,"] ",e.name]},e.id))})]})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(n.J,{htmlFor:"description",children:"Description *"}),(0,t.jsx)(o.T,{id:"description",value:E.description,onChange:e=>J({...E,description:e.target.value}),placeholder:"Describe the waste incident...",rows:3})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(n.J,{htmlFor:"severity",children:"Severity"}),(0,t.jsxs)(m.l6,{value:E.severity,onValueChange:e=>J({...E,severity:e}),children:[(0,t.jsx)(m.bq,{children:(0,t.jsx)(m.yv,{})}),(0,t.jsxs)(m.gC,{children:[(0,t.jsx)(m.eb,{value:"low",children:"Low"}),(0,t.jsx)(m.eb,{value:"medium",children:"Medium"}),(0,t.jsx)(m.eb,{value:"high",children:"High"}),(0,t.jsx)(m.eb,{value:"critical",children:"Critical"})]})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(n.J,{htmlFor:"reported_by",children:"Reported By"}),(0,t.jsx)(d.p,{id:"reported_by",value:E.reported_by,onChange:e=>J({...E,reported_by:e.target.value}),placeholder:"Your name"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(n.J,{htmlFor:"cost_impact",children:"Cost Impact ($)"}),(0,t.jsx)(d.p,{id:"cost_impact",type:"number",value:E.cost_impact,onChange:e=>J({...E,cost_impact:e.target.value}),placeholder:"e.g., 5000"})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(n.J,{htmlFor:"time_impact",children:"Time Impact (hours)"}),(0,t.jsx)(d.p,{id:"time_impact",type:"number",value:E.time_impact_hours,onChange:e=>J({...E,time_impact_hours:e.target.value}),placeholder:"e.g., 8"})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(n.J,{htmlFor:"root_cause",children:"Root Cause"}),(0,t.jsx)(o.T,{id:"root_cause",value:E.root_cause,onChange:e=>J({...E,root_cause:e.target.value}),placeholder:"What caused this waste?",rows:2})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(n.J,{htmlFor:"corrective_action",children:"Corrective Action"}),(0,t.jsx)(o.T,{id:"corrective_action",value:E.corrective_action,onChange:e=>J({...E,corrective_action:e.target.value}),placeholder:"What actions will be taken to prevent recurrence?",rows:2})]})]}),(0,t.jsxs)(x.Es,{children:[(0,t.jsx)(c.$,{variant:"outline",onClick:()=>L(!1),children:"Cancel"}),(0,t.jsx)(c.$,{onClick:z,disabled:R,children:R?"Reporting...":"Report Incident"})]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,t.jsx)(i.Zp,{children:(0,t.jsx)(i.Wu,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-red-100 dark:bg-red-900 rounded-lg",children:(0,t.jsx)(w.A,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:(null==e?void 0:e.length)||0}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total Incidents"})]})]})})}),(0,t.jsx)(i.Zp,{children:(0,t.jsx)(i.Wu,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-orange-100 dark:bg-orange-900 rounded-lg",children:(0,t.jsx)(f.A,{className:"h-5 w-5 text-orange-600 dark:text-orange-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:U}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"High/Critical"})]})]})})}),(0,t.jsx)(i.Zp,{children:(0,t.jsx)(i.Wu,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-yellow-100 dark:bg-yellow-900 rounded-lg",children:(0,t.jsx)(A.A,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:$(B)}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Cost Impact"})]})]})})}),(0,t.jsx)(i.Zp,{children:(0,t.jsx)(i.Wu,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:(0,t.jsx)(v.A,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-2xl font-bold",children:[P,"h"]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Time Lost"})]})]})})})]}),(0,t.jsxs)(i.Zp,{children:[(0,t.jsxs)(i.aR,{children:[(0,t.jsx)(i.ZB,{children:"DOWNTIME Waste Breakdown"}),(0,t.jsx)(i.BT,{children:"Incidents by waste category"})]}),(0,t.jsx)(i.Wu,{children:(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4",children:(j||[]).map(e=>(0,t.jsxs)("div",{className:"p-4 bg-muted/50 rounded-lg text-center hover:bg-muted transition-colors",children:[(0,t.jsx)("div",{className:"flex justify-center mb-2 text-muted-foreground",children:D[e.code]||(0,t.jsx)(w.A,{className:"h-4 w-4"})}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:e.incident_count}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground truncate",title:e.name,children:[e.code," - ",e.name]}),(0,t.jsx)("p",{className:"text-xs text-red-500 mt-1",children:$(e.total_cost_impact)})]},e.id))})})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(C.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(d.p,{placeholder:"Search incidents...",value:N,onChange:e=>b(e.target.value),className:"pl-10"})]}),(0,t.jsxs)(m.l6,{value:_,onValueChange:I,children:[(0,t.jsxs)(m.bq,{className:"w-full sm:w-[150px]",children:[(0,t.jsx)(M.A,{className:"h-4 w-4 mr-2"}),(0,t.jsx)(m.yv,{placeholder:"Severity"})]}),(0,t.jsxs)(m.gC,{children:[(0,t.jsx)(m.eb,{value:"all",children:"All Severity"}),(0,t.jsx)(m.eb,{value:"low",children:"Low"}),(0,t.jsx)(m.eb,{value:"medium",children:"Medium"}),(0,t.jsx)(m.eb,{value:"high",children:"High"}),(0,t.jsx)(m.eb,{value:"critical",children:"Critical"})]})]}),(0,t.jsxs)(m.l6,{value:q,onValueChange:T,children:[(0,t.jsxs)(m.bq,{className:"w-full sm:w-[180px]",children:[(0,t.jsx)(M.A,{className:"h-4 w-4 mr-2"}),(0,t.jsx)(m.yv,{placeholder:"Category"})]}),(0,t.jsxs)(m.gC,{children:[(0,t.jsx)(m.eb,{value:"all",children:"All Categories"}),(y||[]).map(e=>(0,t.jsxs)(m.eb,{value:e.id,children:["[",e.code,"] ",e.name]},e.id))]})]})]}),(0,t.jsx)(i.Zp,{children:(0,t.jsx)(i.Wu,{className:"p-0",children:(0,t.jsxs)(p.XI,{children:[(0,t.jsx)(p.A0,{children:(0,t.jsxs)(p.Hj,{children:[(0,t.jsx)(p.nd,{children:"Date"}),(0,t.jsx)(p.nd,{children:"Category"}),(0,t.jsx)(p.nd,{children:"Description"}),(0,t.jsx)(p.nd,{children:"Severity"}),(0,t.jsx)(p.nd,{children:"Cost Impact"}),(0,t.jsx)(p.nd,{children:"Status"})]})}),(0,t.jsx)(p.BF,{children:0===O.length?(0,t.jsx)(p.Hj,{children:(0,t.jsx)(p.nA,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No waste incidents found"})}):O.map(e=>(0,t.jsxs)(p.Hj,{children:[(0,t.jsx)(p.nA,{className:"whitespace-nowrap",children:new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),(0,t.jsx)(p.nA,{children:(0,t.jsx)(h.E,{variant:"outline",children:e.waste_name||"Unknown"})}),(0,t.jsx)(p.nA,{className:"max-w-[300px] truncate",children:e.description}),(0,t.jsx)(p.nA,{children:(0,t.jsx)(h.E,{className:F[e.severity]||F.medium,children:e.severity})}),(0,t.jsx)(p.nA,{className:"text-red-500 font-medium",children:$(e.estimated_cost_impact)}),(0,t.jsx)(p.nA,{children:(0,t.jsx)(h.E,{className:W[e.status]||W.open,children:e.status.replace("_"," ")})})]},e.id))})]})})})]})}},9572:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(157).A)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])}},e=>{e.O(0,[668,4956,6671,1859,7710,4443,9347,8441,5964,7358],()=>e(e.s=4384)),_N_E=e.O()}]);