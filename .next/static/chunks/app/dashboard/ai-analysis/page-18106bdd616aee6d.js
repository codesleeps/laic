(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5865],{3770:(e,s,a)=>{"use strict";async function t(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"low",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"google",t=await fetch("/api/ai/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"text",prompt:e,reasoningEffort:s,modelProvider:a})});if(!t.ok)throw Error((await t.json()).error||"Failed to generate text");return(await t.json()).data}async function r(e,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"low",t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"google",r=await fetch("/api/ai/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"object",prompt:e,jsonSchema:s,reasoningEffort:a,modelProvider:t})});if(!r.ok)throw Error((await r.json()).error||"Failed to generate object");return(await r.json()).data}a.d(s,{Df:()=>t,Q2:()=>l,pY:()=>r});let l={openai:{name:"OpenAI",models:{low:"GPT-4o Mini",medium:"GPT-4o",high:"o1-preview"}},google:{name:"Google Gemini",models:{low:"Gemini 2.0 Flash",medium:"Gemini 2.5 Flash",high:"Gemini 2.5 Pro"}},openrouter:{name:"OpenRouter",models:{low:"Gemini 2.0 Flash (Free)",medium:"Gemini 2.5 Flash",high:"Claude Sonnet 4"}}}},4944:(e,s,a)=>{"use strict";a.d(s,{k:()=>n});var t=a(5155),r=a(5863),l=a(2115),i=a(1870);let n=l.forwardRef((e,s)=>{let{className:a,value:l,...n}=e;return(0,t.jsx)(r.bL,{ref:s,className:(0,i.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",a),...n,children:(0,t.jsx)(r.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(l||0),"%)")}})})});n.displayName=r.bL.displayName},5797:(e,s,a)=>{Promise.resolve().then(a.bind(a,9479))},7313:(e,s,a)=>{"use strict";a.d(s,{Xi:()=>d,av:()=>o,j7:()=>c,tU:()=>n});var t=a(5155),r=a(704),l=a(2115),i=a(1870);let n=r.bL,c=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.B8,{ref:s,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...l})});c.displayName=r.B8.displayName;let d=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.l9,{ref:s,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...l})});d.displayName=r.l9.displayName;let o=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.UC,{ref:s,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...l})});o.displayName=r.UC.displayName},9479:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>I});var t=a(5155),r=a(2115),l=a(7070),i=a(8390),n=a(1920),c=a(5263),d=a(5554),o=a(4601),m=a(7554),x=a(3300),u=a(5300),h=a(8718),p=a(7569),g=a(9829),j=a(1133),f=a(1203),v=a(7648),y=a(8127),b=a(285),N=a(6695),w=a(6126),k=a(4944),A=a(7313),C=a(9409),S=a(6671),D=a(3770),E=a(3989);let R=[{id:"waste-analysis",name:"Waste Analysis",description:"Identify and quantify the 8 wastes across projects",icon:l.A,color:"text-red-500",bgColor:"bg-red-100 dark:bg-red-900/30"},{id:"cost-forecast",name:"Cost Forecasting",description:"Predict budget trends and identify savings opportunities",icon:i.A,color:"text-green-500",bgColor:"bg-green-100 dark:bg-green-900/30"},{id:"schedule-risk",name:"Schedule Risk",description:"Analyze schedule risks and predict potential delays",icon:n.A,color:"text-orange-500",bgColor:"bg-orange-100 dark:bg-orange-900/30"},{id:"performance",name:"Performance Analysis",description:"Evaluate project KPIs and team productivity",icon:c.A,color:"text-blue-500",bgColor:"bg-blue-100 dark:bg-blue-900/30"}];function I(){var e,s;let{data:a}=(0,E.YK)(),{data:i}=(0,E.PV)(),{data:n}=(0,E.GI)(),[c,I]=(0,r.useState)("all"),[P,B]=(0,r.useState)("waste-analysis"),[F,L]=(0,r.useState)("google"),[T,W]=(0,r.useState)("medium"),[Z,G]=(0,r.useState)(!1),[O,q]=(0,r.useState)(0),[z,Q]=(0,r.useState)(null),[X,K]=(0,r.useState)([]),_=async()=>{G(!0),q(0),Q(null);let e=setInterval(()=>{q(s=>s>=90?(clearInterval(e),s):s+10)},500);try{var s;let t="all"!==c?"Analyzing project: ".concat(null==a||null==(s=a.find(e=>e.id===c))?void 0:s.name):"Analyzing all ".concat((null==a?void 0:a.length)||0," projects"),r=i?"Current waste incidents: ".concat(i.length," total, including ").concat(i.filter(e=>"critical"===e.severity).length," critical issues."):"",l="You are a Lean construction AI analyst. ".concat(t,". ").concat(r,"\n\nGenerate a comprehensive ").concat(P," report with the following structure:\n- A summary paragraph\n- Waste breakdown by category with percentages and costs\n- Top 5 recommendations with priority, savings potential, and effort level\n- Key risk factors with probability and impact ratings\n- Current KPIs with targets and trends\n\nBase the analysis on Lean construction principles and the DOWNTIME waste framework."),n={type:"object",properties:{summary:{type:"string",description:"Executive summary of the analysis"},wasteBreakdown:{type:"array",items:{type:"object",properties:{category:{type:"string"},percentage:{type:"number"},cost:{type:"number"}},required:["category","percentage","cost"]}},recommendations:{type:"array",items:{type:"object",properties:{title:{type:"string"},priority:{type:"string"},savings:{type:"number"},effort:{type:"string"}},required:["title","priority","savings","effort"]}},riskFactors:{type:"array",items:{type:"object",properties:{risk:{type:"string"},probability:{type:"string"},impact:{type:"string"}},required:["risk","probability","impact"]}},kpis:{type:"array",items:{type:"object",properties:{metric:{type:"string"},current:{type:"number"},target:{type:"number"},trend:{type:"string"}},required:["metric","current","target","trend"]}}},required:["summary","wasteBreakdown","recommendations","riskFactors","kpis"]},d=await (0,D.pY)(l,n,T,F);clearInterval(e),q(100),Q(d),K(e=>[{id:Date.now().toString(),type:P,date:new Date,status:"completed",provider:D.Q2[F].name},...e.slice(0,9)]),S.oR.success("Analysis completed using ".concat(D.Q2[F].name,"!"))}catch(s){console.error("Analysis error:",s),clearInterval(e),q(0),S.oR.error(s instanceof Error?s.message:"Analysis failed. Please try again.")}finally{G(!1)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,t.jsx)(d.A,{className:"h-6 w-6 text-purple-600"}),"AI Analysis Engine"]}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Advanced analytics powered by machine learning"})]}),(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-3",children:(0,t.jsxs)(C.l6,{value:c,onValueChange:I,children:[(0,t.jsx)(C.bq,{className:"w-[180px]",children:(0,t.jsx)(C.yv,{placeholder:"Select project"})}),(0,t.jsxs)(C.gC,{children:[(0,t.jsx)(C.eb,{value:"all",children:"All Projects"}),null==a?void 0:a.map(e=>(0,t.jsx)(C.eb,{value:e.id,children:e.name},e.id))]})]})})]}),(0,t.jsx)(N.Zp,{className:"bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-950/20 dark:to-blue-950/20 border-purple-200 dark:border-purple-800",children:(0,t.jsx)(N.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(o.A,{className:"h-5 w-5 text-purple-600"}),(0,t.jsx)("span",{className:"font-medium",children:"AI Provider"})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,t.jsxs)(C.l6,{value:F,onValueChange:e=>L(e),children:[(0,t.jsx)(C.bq,{className:"w-[180px] bg-white dark:bg-gray-900",children:(0,t.jsx)(C.yv,{placeholder:"Select provider"})}),(0,t.jsxs)(C.gC,{children:[(0,t.jsx)(C.eb,{value:"google",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{children:"\uD83D\uDD37"}),(0,t.jsx)("span",{children:"Google Gemini"})]})}),(0,t.jsx)(C.eb,{value:"openai",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{children:"\uD83D\uDFE2"}),(0,t.jsx)("span",{children:"OpenAI"})]})}),(0,t.jsx)(C.eb,{value:"openrouter",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{children:"\uD83D\uDD00"}),(0,t.jsx)("span",{children:"OpenRouter"})]})})]})]}),(0,t.jsxs)(C.l6,{value:T,onValueChange:e=>W(e),children:[(0,t.jsx)(C.bq,{className:"w-[160px] bg-white dark:bg-gray-900",children:(0,t.jsx)(C.yv,{placeholder:"Model tier"})}),(0,t.jsxs)(C.gC,{children:[(0,t.jsx)(C.eb,{value:"low",children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{children:"⚡ Fast"}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:D.Q2[F].models.low})]})}),(0,t.jsx)(C.eb,{value:"medium",children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{children:"⚖️ Balanced"}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:D.Q2[F].models.medium})]})}),(0,t.jsx)(C.eb,{value:"high",children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{children:"\uD83E\uDDE0 Advanced"}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:D.Q2[F].models.high})]})})]})]}),(0,t.jsxs)(w.E,{variant:"outline",className:"bg-white dark:bg-gray-900",children:["Using: ",D.Q2[F].models[T]]})]})]})})}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:R.map(e=>(0,t.jsx)(N.Zp,{className:"cursor-pointer transition-all ".concat(P===e.id?"ring-2 ring-blue-500 border-blue-500":"hover:border-blue-300"),onClick:()=>B(e.id),children:(0,t.jsx)(N.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"p-2 rounded-lg ".concat(e.bgColor),children:(0,t.jsx)(e.icon,{className:"h-5 w-5 ".concat(e.color)})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium",children:e.name}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]})})},e.id))}),(0,t.jsx)(N.Zp,{children:(0,t.jsxs)(N.Wu,{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold",children:null==(e=R.find(e=>e.id===P))?void 0:e.name}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"all"===c?"Analyzing all ".concat((null==a?void 0:a.length)||0," projects"):"Analyzing: ".concat(null==a||null==(s=a.find(e=>e.id===c))?void 0:s.name)})]}),(0,t.jsx)(b.$,{size:"lg",onClick:_,disabled:Z,className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:Z?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Analyzing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Run Analysis"]})})]}),Z&&(0,t.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"Processing data..."}),(0,t.jsxs)("span",{children:[O,"%"]})]}),(0,t.jsx)(k.k,{value:O,className:"h-2"})]})]})}),z&&(0,t.jsxs)(A.tU,{defaultValue:"summary",className:"space-y-4",children:[(0,t.jsxs)(A.j7,{className:"grid grid-cols-5 w-full max-w-2xl",children:[(0,t.jsx)(A.Xi,{value:"summary",children:"Summary"}),(0,t.jsx)(A.Xi,{value:"waste",children:"Waste"}),(0,t.jsx)(A.Xi,{value:"recommendations",children:"Actions"}),(0,t.jsx)(A.Xi,{value:"risks",children:"Risks"}),(0,t.jsx)(A.Xi,{value:"kpis",children:"KPIs"})]}),(0,t.jsx)(A.av,{value:"summary",children:(0,t.jsxs)(N.Zp,{children:[(0,t.jsxs)(N.aR,{children:[(0,t.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(u.A,{className:"h-5 w-5"}),"Executive Summary"]}),(0,t.jsxs)(N.BT,{children:["Generated on ",new Date().toLocaleDateString()," at ",new Date().toLocaleTimeString()]})]}),(0,t.jsxs)(N.Wu,{children:[(0,t.jsx)("p",{className:"text-muted-foreground leading-relaxed",children:z.summary}),(0,t.jsxs)("div",{className:"mt-6 flex gap-3",children:[(0,t.jsxs)(b.$,{variant:"outline",size:"sm",children:[(0,t.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Export PDF"]}),(0,t.jsxs)(b.$,{variant:"outline",size:"sm",children:[(0,t.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Save Report"]})]})]})]})}),(0,t.jsx)(A.av,{value:"waste",children:(0,t.jsxs)(N.Zp,{children:[(0,t.jsxs)(N.aR,{children:[(0,t.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(l.A,{className:"h-5 w-5 text-red-500"}),"Waste Breakdown"]}),(0,t.jsx)(N.BT,{children:"Distribution of waste across DOWNTIME categories"})]}),(0,t.jsx)(N.Wu,{children:(0,t.jsx)("div",{className:"space-y-4",children:z.wasteBreakdown.map((e,s)=>(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"font-medium",children:e.category}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:["$",e.cost.toLocaleString()]}),(0,t.jsxs)("span",{className:"font-semibold",children:[e.percentage,"%"]})]})]}),(0,t.jsx)(k.k,{value:e.percentage,className:"h-2"})]},s))})})]})}),(0,t.jsx)(A.av,{value:"recommendations",children:(0,t.jsxs)(N.Zp,{children:[(0,t.jsxs)(N.aR,{children:[(0,t.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(p.A,{className:"h-5 w-5 text-yellow-500"}),"Recommended Actions"]}),(0,t.jsx)(N.BT,{children:"AI-generated improvement recommendations"})]}),(0,t.jsx)(N.Wu,{children:(0,t.jsx)("div",{className:"space-y-4",children:z.recommendations.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:(0,t.jsx)(g.A,{className:"h-4 w-4 text-blue-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium",children:e.title}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,t.jsx)(w.E,{className:(e=>{switch(e.toLowerCase()){case"high":return"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400";case"medium":return"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400";case"low":return"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400";default:return"bg-gray-100 text-gray-700"}})(e.priority),children:e.priority}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Effort: ",e.effort]})]})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"font-semibold text-green-600",children:["$",e.savings.toLocaleString()]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Potential savings"})]})]},s))})})]})}),(0,t.jsx)(A.av,{value:"risks",children:(0,t.jsxs)(N.Zp,{children:[(0,t.jsxs)(N.aR,{children:[(0,t.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(j.A,{className:"h-5 w-5 text-orange-500"}),"Risk Factors"]}),(0,t.jsx)(N.BT,{children:"Identified risks and their potential impact"})]}),(0,t.jsx)(N.Wu,{children:(0,t.jsx)("div",{className:"space-y-3",children:z.riskFactors.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,t.jsx)("div",{children:(0,t.jsx)("h4",{className:"font-medium",children:e.risk})}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Probability"}),(0,t.jsx)(w.E,{variant:"outline",children:e.probability})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Impact"}),(0,t.jsx)(w.E,{className:"high"===e.impact.toLowerCase()?"bg-red-100 text-red-700":"medium"===e.impact.toLowerCase()?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700",children:e.impact})]})]})]},s))})})]})}),(0,t.jsx)(A.av,{value:"kpis",children:(0,t.jsxs)(N.Zp,{children:[(0,t.jsxs)(N.aR,{children:[(0,t.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(f.A,{className:"h-5 w-5 text-blue-500"}),"Key Performance Indicators"]}),(0,t.jsx)(N.BT,{children:"Current performance vs targets"})]}),(0,t.jsx)(N.Wu,{children:(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:z.kpis.map((e,s)=>{var a;return(0,t.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:e.metric}),(a=e.trend).toLowerCase().includes("up")||a.toLowerCase().includes("improv")?(0,t.jsx)(l.A,{className:"h-4 w-4 text-green-500 rotate-180"}):(0,t.jsx)(l.A,{className:"h-4 w-4 text-red-500"})]}),(0,t.jsxs)("div",{className:"flex items-end justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-2xl font-bold",children:e.current}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground ml-1",children:["/ ",e.target]})]}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:e.trend})]}),(0,t.jsx)(k.k,{value:Math.min(e.current/e.target*100,100),className:"h-1 mt-2"})]},s)})})})]})})]}),(0,t.jsxs)(N.Zp,{children:[(0,t.jsx)(N.aR,{children:(0,t.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(v.A,{className:"h-5 w-5"}),"Recent Analyses"]})}),(0,t.jsx)(N.Wu,{children:0===X.length?(0,t.jsx)("p",{className:"text-muted-foreground text-center py-8",children:'No analyses run yet. Select an analysis type and click "Run Analysis" to get started.'}):(0,t.jsx)("div",{className:"space-y-2",children:X.map(e=>{var s;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(y.A,{className:"h-4 w-4 text-green-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-sm",children:null==(s=R.find(s=>s.id===e.type))?void 0:s.name}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.date.toLocaleString()," • ",e.provider]})]})]}),(0,t.jsx)(w.E,{variant:"outline",className:"text-green-600",children:e.status})]},e.id)})})})]})]})}}},e=>{e.O(0,[668,4956,6671,1859,7710,7257,8348,8441,5964,7358],()=>e(e.s=5797)),_N_E=e.O()}]);