(()=>{var a={};a.id=6898,a.ids=[6898],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},16645:(a,b,c)=>{"use strict";c.r(b),c.d(b,{"40730d261cb23b8051c8d8ae8ce4f9717e753e939c":()=>d.POST});var d=c(57626)},17478:(a,b)=>{"use strict";function c(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(b,"D",{enumerable:!0,get:function(){return c}})},28354:a=>{"use strict";a.exports=require("util")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},38960:(a,b,c)=>{"use strict";c.r(b),c.d(b,{handler:()=>z,patchFetch:()=>y,routeModule:()=>u,serverHooks:()=>x,workAsyncStorage:()=>v,workUnitAsyncStorage:()=>w});var d=c(96559),e=c(48088),f=c(37719),g=c(26191),h=c(81289),i=c(261),j=c(92603),k=c(39893),l=c(14823),m=c(47220),n=c(66946),o=c(47912),p=c(99786),q=c(46143),r=c(86439),s=c(43365),t=c(57626);let u=new d.AppRouteRouteModule({definition:{kind:e.RouteKind.APP_ROUTE,page:"/api/ai/generate/route",pathname:"/api/ai/generate",filename:"route",bundlePath:"app/api/ai/generate/route"},distDir:".next",projectDir:"",resolvedPagePath:"/Users/user/Desktop/laic/src/app/api/ai/generate/route.ts",nextConfigOutput:"",userland:t}),{workAsyncStorage:v,workUnitAsyncStorage:w,serverHooks:x}=u;function y(){return(0,f.patchFetch)({workAsyncStorage:v,workUnitAsyncStorage:w})}async function z(a,b,c){var d;let f="/api/ai/generate/route";"/index"===f&&(f="/");let t=await u.prepare(a,b,{srcPage:f,multiZoneDraftMode:"false"});if(!t)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:v,params:w,nextConfig:x,isDraftMode:y,prerenderManifest:z,routerServerContext:A,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,resolvedPathname:D}=t,E=(0,i.normalizeAppPath)(f),F=!!(z.dynamicRoutes[E]||z.routes[D]);if(F&&!y){let a=!!z.routes[D],b=z.dynamicRoutes[E];if(b&&!1===b.fallback&&!a)throw new r.NoFallbackError}let G=null;!F||u.isDev||y||(G="/index"===(G=D)?"/":G);let H=!0===u.isDev||!F,I=F&&!H,J=a.method||"GET",K=(0,h.getTracer)(),L=K.getActiveScopeSpan(),M={params:w,prerenderManifest:z,renderOpts:{experimental:{dynamicIO:!!x.experimental.dynamicIO,authInterrupts:!!x.experimental.authInterrupts},supportsDynamicResponse:H,incrementalCache:(0,g.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=x.experimental)?void 0:d.cacheLife,isRevalidate:I,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>u.onRequestError(a,b,d,A)},sharedContext:{buildId:v}},N=new j.NodeNextRequest(a),O=new j.NodeNextResponse(b),P=k.NextRequestAdapter.fromNodeNextRequest(N,(0,k.signalFromNodeResponse)(b));try{let d=async c=>u.handle(P,M).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=K.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==l.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${J} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${J} ${a.url}`)}),i=async h=>{var i,j;let k=async({previousCacheEntry:e})=>{try{if(!(0,g.getRequestMeta)(a,"minimalMode")&&B&&C&&!e)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let f=await d(h);a.fetchMetrics=M.renderOpts.fetchMetrics;let i=M.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=M.renderOpts.collectedTags;if(!F)return await (0,n.I)(N,O,f,M.renderOpts.pendingWaitUntil),null;{let a=await f.blob(),b=(0,o.toNodeOutgoingHttpHeaders)(f.headers);j&&(b[q.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=q.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,d=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=q.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:s.CachedRouteKind.APP_ROUTE,status:f.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==e?void 0:e.isStale)&&await u.onRequestError(a,b,{routerKind:"App Router",routePath:f,routeType:"route",revalidateReason:(0,m.c)({isRevalidate:I,isOnDemandRevalidate:B})},A),b}},l=await u.handleResponse({req:a,nextConfig:x,cacheKey:G,routeKind:e.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:z,isRoutePPREnabled:!1,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,responseGenerator:k,waitUntil:c.waitUntil});if(!F)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==s.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,g.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",B?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),y&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let r=(0,o.fromNodeOutgoingHttpHeaders)(l.value.headers);return(0,g.getRequestMeta)(a,"minimalMode")&&F||r.delete(q.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||r.get("Cache-Control")||r.set("Cache-Control",(0,p.getCacheControlHeader)(l.cacheControl)),await (0,n.I)(N,O,new Response(l.value.body,{headers:r,status:l.value.status||200})),null};L?await i(L):await K.withPropagatedContext(a.headers,()=>K.trace(l.BaseServerSpan.handleRequest,{spanName:`${J} ${a.url}`,kind:h.SpanKind.SERVER,attributes:{"http.method":J,"http.target":a.url}},i))}catch(b){if(L||b instanceof r.NoFallbackError||await u.onRequestError(a,b,{routerKind:"App Router",routePath:E,routeType:"route",revalidateReason:(0,m.c)({isRevalidate:I,isOnDemandRevalidate:B})}),F)throw b;return await (0,n.I)(N,O,new Response(null,{status:500})),null}}},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},57626:(a,b,c)=>{"use strict";c.r(b),c.d(b,{POST:()=>m});var d=c(67218);c(79130);var e=c(32190),f=c(17478);let g={openai:{low:"gpt-4o-mini",medium:"gpt-4o",high:"o1-preview"},google:{low:"gemini-3-flash-preview",medium:"gemini-2.5-flash-preview-05-20",high:"gemini-2.5-pro-preview-06-05"},openrouter:{low:"z-ai/glm-4.7",medium:"z-ai/glm-4-32b",high:"deepseek/deepseek-v3.2-speciale"}};function h(a){switch(a){case"openai":return process.env.API_KEY_OPENAI;case"google":return process.env.API_KEY_GEMINIAI;case"openrouter":return process.env.API_KEY_OPENROUTER}}async function i(a,b,c){let d=h("openai");if(!d)throw Error("OpenAI API key not configured");let e={model:b,messages:[{role:"user",content:a}]};c&&(e.response_format={type:"json_schema",json_schema:{name:"response",schema:c,strict:!0}});let f=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify(e)});if(!f.ok){let a=await f.text();throw Error(`OpenAI API error: ${a}`)}let g=await f.json();return g.choices[0]?.message?.content||""}async function j(a,b,c){let d=h("google");if(!d)throw Error("Google Gemini API key not configured");let e={contents:[{parts:[{text:a}]}]};c&&(e.generationConfig={responseMimeType:"application/json",responseSchema:c});let f=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${b}:generateContent?key=${d}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!f.ok){let a=await f.text();throw Error(`Gemini API error: ${a}`)}let g=await f.json();return g.candidates?.[0]?.content?.parts?.[0]?.text||""}async function k(a,b,c){let d=h("openrouter");if(!d)throw Error("OpenRouter API key not configured");let e={model:b,messages:[{role:"user",content:a}]};c&&(e.response_format={type:"json_schema",json_schema:{name:"response",schema:c,strict:!0}});let f=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`,"HTTP-Referer":process.env.NEXT_PUBLIC_APP_URL||"http://localhost:3000","X-Title":"LeanBuild AI"},body:JSON.stringify(e)});if(!f.ok){let a=await f.text();throw Error(`OpenRouter API error: ${a}`)}let g=await f.json();return g.choices?.[0]?.message?.content||""}async function l(a,b,c,d){let e=g[b][c];switch(b){case"openai":return i(a,e,d);case"google":return j(a,e,d);case"openrouter":return k(a,e,d)}}async function m(a){try{let b=await a.json(),{type:c}=b;if("text"===c){let{prompt:a,reasoningEffort:c="low",modelProvider:d="google"}=b,f=await l(a,d,c);return e.NextResponse.json({success:!0,data:f})}if("object"!==c)return e.NextResponse.json({success:!1,error:"Invalid type. Use 'text' or 'object'"},{status:400});{let{prompt:a,jsonSchema:c,reasoningEffort:d="low",modelProvider:f="google"}=b,g=await l(a,f,d,c);try{let a=JSON.parse(g);return e.NextResponse.json({success:!0,data:a})}catch{return e.NextResponse.json({success:!0,data:g})}}}catch(a){return console.error("AI generation error:",a),e.NextResponse.json({success:!1,error:a instanceof Error?a.message:"Unknown error"},{status:500})}}(0,f.D)([m]),(0,d.A)(m,"40730d261cb23b8051c8d8ae8ce4f9717e753e939c",null)},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66946:(a,b,c)=>{"use strict";Object.defineProperty(b,"I",{enumerable:!0,get:function(){return g}});let d=c(30898),e=c(42471),f=c(47912);async function g(a,b,c,g){if((0,d.isNodeNextResponse)(b)){var h;b.statusCode=c.status,b.statusMessage=c.statusText;let d=["set-cookie","www-authenticate","proxy-authenticate","vary"];null==(h=c.headers)||h.forEach((a,c)=>{if("x-middleware-set-cookie"!==c.toLowerCase())if("set-cookie"===c.toLowerCase())for(let d of(0,f.splitCookiesString)(a))b.appendHeader(c,d);else{let e=void 0!==b.getHeader(c);(d.includes(c.toLowerCase())||!e)&&b.appendHeader(c,a)}});let{originalResponse:i}=b;c.body&&"HEAD"!==a.method?await (0,e.pipeToNodeResponse)(c.body,i,g):i.end()}}},67218:(a,b,c)=>{"use strict";Object.defineProperty(b,"A",{enumerable:!0,get:function(){return d.registerServerReference}});let d=c(61369)},78335:()=>{},79130:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{decryptActionBoundArgs:function(){return q},encryptActionBoundArgs:function(){return p}}),c(34822);let d=c(61369),e=c(85624),f=c(77855),g=c(82602),h=c(63033),i=c(84971),j=function(a){return a&&a.__esModule?a:{default:a}}(c(61120)),k=new TextEncoder,l=new TextDecoder;async function m(a,b){let c=await (0,g.getActionEncryptionKey)();if(void 0===c)throw Object.defineProperty(Error("Missing encryption key for Server Action. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E65",enumerable:!1,configurable:!0});let d=atob(b),e=d.slice(0,16),f=d.slice(16),h=l.decode(await (0,g.decrypt)(c,(0,g.stringToUint8Array)(e),(0,g.stringToUint8Array)(f)));if(!h.startsWith(a))throw Object.defineProperty(Error("Invalid Server Action payload: failed to decrypt."),"__NEXT_ERROR_CODE",{value:"E191",enumerable:!1,configurable:!0});return h.slice(a.length)}async function n(a,b){let c=await (0,g.getActionEncryptionKey)();if(void 0===c)throw Object.defineProperty(Error("Missing encryption key for Server Action. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E65",enumerable:!1,configurable:!0});let d=new Uint8Array(16);h.workUnitAsyncStorage.exit(()=>crypto.getRandomValues(d));let e=(0,g.arrayBufferToString)(d.buffer),f=await (0,g.encrypt)(c,d,k.encode(a+b));return btoa(e+(0,g.arrayBufferToString)(f))}var o=function(a){return a[a.Ready=0]="Ready",a[a.Pending=1]="Pending",a[a.Complete=2]="Complete",a}(o||{});let p=j.default.cache(async function a(b,...c){let e=h.workUnitAsyncStorage.getStore(),j=(null==e?void 0:e.type)==="prerender"?e.cacheSignal:void 0,{clientModules:k}=(0,g.getClientReferenceManifestForRsc)(),l=Error();Error.captureStackTrace(l,a);let m=!1,o=(null==e?void 0:e.type)==="prerender"?(0,i.createHangingInputAbortSignal)(e):void 0,p=0;function q(){0===p&&(p=1,null==j||j.beginRead())}function r(){1===p&&(null==j||j.endRead()),p=2}o&&j&&o.addEventListener("abort",q,{once:!0});let s=await (0,f.streamToString)((0,d.renderToReadableStream)(c,k,{filterStackFrame:void 0,signal:o,onError(a){(null==o||!o.aborted)&&(m||(m=!0,l.message=a instanceof Error?a.message:String(a)))}}),o);if(m)throw r(),l;if(!e)return n(b,s);q();let t=(0,h.getPrerenderResumeDataCache)(e),u=(0,h.getRenderResumeDataCache)(e),v=b+s,w=(null==t?void 0:t.encryptedBoundArgs.get(v))??(null==u?void 0:u.encryptedBoundArgs.get(v));if(w)return w;let x=await n(b,s);return r(),null==t||t.encryptedBoundArgs.set(v,x),x});async function q(a,b){let c,d=await b,f=h.workUnitAsyncStorage.getStore();if(f){let b="prerender"===f.type?f.cacheSignal:void 0,e=(0,h.getPrerenderResumeDataCache)(f),g=(0,h.getRenderResumeDataCache)(f);(c=(null==e?void 0:e.decryptedBoundArgs.get(d))??(null==g?void 0:g.decryptedBoundArgs.get(d)))||(null==b||b.beginRead(),c=await m(a,d),null==b||b.endRead(),null==e||e.decryptedBoundArgs.set(d,c))}else c=await m(a,d);let{edgeRscModuleMapping:i,rscModuleMapping:j}=(0,g.getClientReferenceManifestForRsc)();return await (0,e.createFromReadableStream)(new ReadableStream({start(a){a.enqueue(k.encode(c)),(null==f?void 0:f.type)==="prerender"?f.renderSignal.aborted?a.close():f.renderSignal.addEventListener("abort",()=>a.close(),{once:!0}):a.close()}}),{serverConsumerManifest:{moduleLoading:null,moduleMap:j,serverModuleMap:(0,g.getServerModuleMap)()}})}},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},96487:()=>{},96559:(a,b,c)=>{"use strict";a.exports=c(44870)}};var b=require("../../../../webpack-runtime.js");b.C(a);var c=b.X(0,[431,8822,2190],()=>b(b.s=38960));module.exports=c})();